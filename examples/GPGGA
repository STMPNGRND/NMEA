/*
Simple NMEA parsing example for Arduino.  

Handles GPGGA messages by printing out latitude and longitude (degrees:minutes) and altitude (meters).


*/

#include <NMEA.h>

class MyParser : public NMEA_Parser {
  
  void handleGPGGA(GPGGA_Message & gpgga) 
  {
    this->dumpCoord(gpgga.latitude);
    Serial.print(" ");    
    this->dumpCoord(gpgga.longitude);
    Serial.print(" ");
    Height altitude = gpgga.altitude;
    Serial.print(altitude.value);
    Serial.print(altitude.units);
    Serial.println();
  }
  
  void dumpCoord(Coordinate coord) 
  {
    Serial.print(coord.sign == 1 ? "+" : "-");
    Serial.print(coord.degrees);
    Serial.print(":");
    Serial.print(coord.minutes);
  }

};

MyParser parser;

void setup() {
  
  Serial.begin(9600);
  Serial1.begin(9600);
}

void loop() {
  
  if (Serial1.available() > 0) {
    
        parser.parse(Serial1.read());
  }  
}
